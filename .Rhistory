group_by(Mes,Día,Rural.o.urbano) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)  # Seleccionar el primer registro de cada mes (el que tiene la mayor frecuencia)
print(meses_mas_accidentes)
View(registros_mas_frecuentes)
View(data)
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Tipo.ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)  # Seleccionar el primer registro de cada mes (el que tiene la mayor frecuencia)
print(meses_mas_accidentes)
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Tipo.ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)  # Seleccionar el primer registro de cada mes (el que tiene la mayor frecuencia)
print(registros_mas_frecuentes)
View(registros_mas_frecuentes)
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Provincia) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)  # Seleccionar el primer registro de cada mes (el que tiene la mayor frecuencia)
print(registros_mas_frecuentes)
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Cantón) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)  # Seleccionar el primer registro de cada mes (el que tiene la mayor frecuencia)
print(registros_mas_frecuentes)
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Distrito) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)  # Seleccionar el primer registro de cada mes (el que tiene la mayor frecuencia)
print(registros_mas_frecuentes)
View(meses_dias_RU_mas_accidentes)
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)  # Seleccionar el primer registro de cada mes (el que tiene la mayor frecuencia)
print(registros_mas_frecuentes)
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1) %>%
mutate(numero_mes = row_number())
# Seleccionar el primer registro de cada mes (el que tiene la mayor frecuencia)
print(registros_mas_frecuentes)
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
mutate(numero_mes = row_number()) %>%
slice(1)
# Seleccionar el primer registro de cada mes (el que tiene la mayor frecuencia)
print(registros_mas_frecuentes)
View(registros_mas_frecuentes)
View(registros_mas_frecuentes)
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
mutate(numero_mes = 1:12) %>%
slice(1)
View(registros_mas_frecuentes)
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)
# Seleccionar el primer registro de cada mes (el que tiene la mayor frecuencia)
print(registros_mas_frecuentes)
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)
mutate(numero_mes = 1:12)
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)
registros_mas_frecuentes <- registros_mas_frecuentes %>%
mutate(numero_mes = 1:12)
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)
# Seleccionar el primer registro de cada mes (el que tiene la mayor frecuencia)
print(registros_mas_frecuentes)
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)
# Crear una secuencia del 1 al 12 con la misma longitud que el número de filas en tu conjunto de datos
numero_mes <- seq(1, 12, length.out = nrow(registros_mas_frecuentes))
# Agregar la columna al conjunto de datos
registros_mas_frecuentes <- cbind(registros_mas_frecuentes, numero_mes)
# Seleccionar el primer registro de cada mes (el que tiene la mayor frecuencia)
print(registros_mas_frecuentes)
View(registros_mas_frecuentes)
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)
numero_mes <- seq(1, 12, length.out = nrow(registros_mas_frecuentes))
registros_mas_frecuentes <- cbind(registros_mas_frecuentes, NumeroMes = numero_mes)
# Seleccionar el primer registro de cada mes (el que tiene la mayor frecuencia)
print(registros_mas_frecuentes)
View(registros_mas_frecuentes)
rango_meses <- min(registros_mas_frecuentes$numeroMes):max(registros_mas_frecuentes$numeroMes)
rango_meses <- min(registros_mas_frecuentes$numeroMes):max(registros_mas_frecuentes$numeroMes)
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[,-1],face.type = "meses_mas_accidentes$numero_mes",col.hair=terrain.colors(length(rango_meses)))
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[,-1],face.type = "registros_mas_frecuentes$NumeroMes",col.hair=terrain.colors(length(rango_meses)))
#obtenemos los meses, dias y si la ruta es urbana o rural donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)
numero_mes <- seq(1, 12, length.out = nrow(registros_mas_frecuentes))
numero_mes <- as.integer(numero_mes)
registros_mas_frecuentes <- cbind(registros_mas_frecuentes, NumeroMes = numero_mes)
print(registros_mas_frecuentes)
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[,-1],face.type = "registros_mas_frecuentes$NumeroMes",col.hair=terrain.colors(length(rango_meses)))
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes$NumeroMes,face.type = "registros_mas_frecuentes$NumeroMes",col.hair=terrain.colors(length(rango_meses)))
# 12 caras por los meses, tamano labios urbano... y tamano ojos dias
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[,-1],face.type = "registros_mas_frecuentes$NumeroMes",col.hair=terrain.colors(length(rango_meses)))
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[,-1],face.type = "registros_mas_frecuentes$NumeroMes",col.hair=terrain.colors(length(rango_meses)))
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[,-1],face.type = "registros_mas_frecuentes$NumeroMes")
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[,-1])
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
registros_mas_frecuentes[, -1] <- sapply(registros_mas_frecuentes[, -1], as.numeric)
grafico_meses <- faces(registros_mas_frecuentes[,-1])
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes$NumeroMes)
# 12 caras por los meses, tamano labios urbano... y tamano ojos dias
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[,-1])
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[registros_mas_frecuentes$NumeroMes,registros_mas_frecuentes$NumeroMes])
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[NumeroMes,NumeroMes])
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
minMes<- min(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[minMes,NumeroMes])
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
minMes<- min(registros_mas_frecuentes$NumeroMes)
maxMes<- max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[minMes,maxMes])
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
minMes<- min(registros_mas_frecuentes$NumeroMes)-1
maxMes<- max(registros_mas_frecuentes$NumeroMes)-1
grafico_meses <- faces(registros_mas_frecuentes[minMes,maxMes])
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
minMes<- min(registros_mas_frecuentes$NumeroMes)
maxMes<- max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[minMes,maxMes])
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
minMes<- min(registros_mas_frecuentes$NumeroMes)
maxMes<- max(registros_mas_frecuentes$NumeroMes)-7
grafico_meses <- faces(registros_mas_frecuentes[minMes,maxMes])
# 12 caras por los meses, tamano labios urbano... y tamano ojos dias
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[,-1])
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[,-1])
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes$NumeroMes, face.type = "chernoff", nfacet = 12)
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes$NumeroMes, nfacet = 12)
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes$NumeroMes)
# 12 caras por los meses, tamano labios urbano... y tamano ojos dias
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[0,5])
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[,5])
# 12 caras por los meses, tamano labios urbano... y tamano ojos dias
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[,5],col.hair = terrain.colors(rango_meses))
# 12 caras por los meses, tamano labios urbano... y tamano ojos dias
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[,5],col.hair = terrain.colors(lenght(rango_meses)))
rango_meses <- min(registros_mas_frecuentes$NumeroMes):max(registros_mas_frecuentes$NumeroMes)
grafico_meses <- faces(registros_mas_frecuentes[,5],col.hair = terrain.colors(length(rango_meses)))
# 12 caras por los meses, tamano labios urbano... y tamano ojos dias
#obtenemos los meses, dias y la ruta donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)
numero_mes <- seq(1, 12, length.out = nrow(registros_mas_frecuentes))
numero_mes <- as.integer(numero_mes)
registros_mas_frecuentes <- cbind(registros_mas_frecuentes, NumeroMes = numero_mes)
numero_dia <- seq(1, nrow(registros_mas_frecuentes))
# Agregar el número del día al dataframe registros_mas_frecuentes
registros_mas_frecuentes <- cbind(registros_mas_frecuentes, NumeroDia = numero_dia)
print(registros_mas_frecuentes)
#obtenemos los meses, dias y la ruta donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)
numero_mes <- seq(1, 12, length.out = nrow(registros_mas_frecuentes))
numero_mes <- as.integer(numero_mes)
registros_mas_frecuentes <- cbind(registros_mas_frecuentes, NumeroMes = numero_mes)
numero_dia <- seq(1, 7)
# Agregar el número del día al dataframe registros_mas_frecuentes
registros_mas_frecuentes <- cbind(registros_mas_frecuentes, NumeroDia = numero_dia)
#obtenemos los meses, dias y la ruta donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)
numero_mes <- seq(1, 12, length.out = nrow(registros_mas_frecuentes))
numero_mes <- as.integer(numero_mes)
registros_mas_frecuentes <- cbind(registros_mas_frecuentes, NumeroMes = numero_mes)
# Crear una columna para el número de día según el día de la semana en registros_mas_frecuentes
registros_mas_frecuentes$NumeroDia <- ifelse(registros_mas_frecuentes$Dia == "Domingo", 1,
ifelse(registros_mas_frecuentes$Dia == "Lunes", 2,
ifelse(registros_mas_frecuentes$Dia == "Martes", 3,
ifelse(registros_mas_frecuentes$Dia == "Miércoles", 4,
ifelse(registros_mas_frecuentes$Dia == "Jueves", 5,
ifelse(registros_mas_frecuentes$Dia == "Viernes", 6,
ifelse(registros_mas_frecuentes$Dia == "Sábado", 7, NA)))))))
#obtenemos los meses, dias y la ruta donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)
numero_mes <- seq(1, 12, length.out = nrow(registros_mas_frecuentes))
numero_mes <- as.integer(numero_mes)
registros_mas_frecuentes <- cbind(registros_mas_frecuentes, NumeroMes = numero_mes)
# Crear una columna para el número de día según el día de la semana en registros_mas_frecuentes
registros_mas_frecuentes$NumeroDia <-ifelse(registros_mas_frecuentes$Dia == "Domingo", 1,
ifelse(registros_mas_frecuentes$Dia == "Lunes", 2,
ifelse(registros_mas_frecuentes$Dia == "Martes", 3,
ifelse(registros_mas_frecuentes$Dia == "Miércoles", 4,
ifelse(registros_mas_frecuentes$Dia == "Jueves", 5,
ifelse(registros_mas_frecuentes$Dia == "Viernes", 6,
ifelse(registros_mas_frecuentes$Dia == "Sábado", 7, NA)))))))
#obtenemos los meses, dias y la ruta donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)
numero_mes <- seq(1, 12, length.out = nrow(registros_mas_frecuentes))
numero_mes <- as.integer(numero_mes)
registros_mas_frecuentes <- cbind(registros_mas_frecuentes, NumeroMes = numero_mes)
# Crear una columna para el número de día según el día de la semana en registros_mas_frecuentes
registros_mas_frecuentes$NumeroDia <-ifelse(registros_mas_frecuentes$Día == "Domingo", 1,
ifelse(registros_mas_frecuentes$Día == "Lunes", 2,
ifelse(registros_mas_frecuentes$Día == "Martes", 3,
ifelse(registros_mas_frecuentes$Día == "Miércoles", 4,
ifelse(registros_mas_frecuentes$Día == "Jueves", 5,
ifelse(registros_mas_frecuentes$Día == "Viernes", 6,
ifelse(registros_mas_frecuentes$Día == "Sábado", 7, NA)))))))
print(registros_mas_frecuentes)
#obtenemos los meses, dias y la ruta donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)
numero_mes <- seq(1, 12, length.out = nrow(registros_mas_frecuentes))
numero_mes <- as.integer(numero_mes)
registros_mas_frecuentes <- cbind(registros_mas_frecuentes, NumeroMes = numero_mes)
# Crear una columna para el número de día según el día de la semana en registros_mas_frecuentes
registros_mas_frecuentes$NumeroDia <-ifelse(registros_mas_frecuentes$Día == "1.Domingo", 1,
ifelse(registros_mas_frecuentes$Día == "2.Lunes", 2,
ifelse(registros_mas_frecuentes$Día == "3.Martes", 3,
ifelse(registros_mas_frecuentes$Día == "4.Miércoles", 4,
ifelse(registros_mas_frecuentes$Día == "5.Jueves", 5,
ifelse(registros_mas_frecuentes$Día == "6.Viernes", 6,
ifelse(registros_mas_frecuentes$Día == "7.Sábado", 7, NA)))))))
print(registros_mas_frecuentes)
rango_meses <- min(registros_mas_frecuentes$NumeroDia):max(registros_mas_frecuentes$NumeroDia)
grafico_meses <- faces(registros_mas_frecuentes[,5],col.hair = terrain.colors(length(rango_meses)))
# 12 caras por los meses, color pelo dias ... y color cara ruta
rango_meses <- min(registros_mas_frecuentes$NumeroDia):max(registros_mas_frecuentes$NumeroDia)
grafico_meses <- faces(registros_mas_frecuentes[,5],col.hair = terrain.colors(length(rango_meses)/10))
# 12 caras por los meses, color pelo dias ... y color cara ruta
rango_meses <- min(registros_mas_frecuentes$NumeroDia):max(registros_mas_frecuentes$NumeroDia)
grafico_meses <- faces(registros_mas_frecuentes[,5],col.hair = terrain.colors(length(rango_meses)))
# 12 caras por los meses, color pelo dias ... y color cara ruta
rango_meses <- min(registros_mas_frecuentes$NumeroDia):max(registros_mas_frecuentes$NumeroDia)
colores_unicos <- unique(registros_mas_frecuentes$Color_de_Cabello)
# Crear una paleta de colores única para cada valor único
colores <- rainbow(length(colores_unicos))
# Asignar un color correspondiente a cada valor único
colores_asignados <- colores[match(registros_mas_frecuentes$Color_de_Cabello, colores_unicos)]
grafico_meses <- faces(registros_mas_frecuentes[,5],col.hair = terrain.colors(colores_asignados))
rango_meses <- min(registros_mas_frecuentes$NumeroDia):max(registros_mas_frecuentes$NumeroDia)
colores_unicos <- unique(registros_mas_frecuentes$Color_de_Cabello)
# Crear una paleta de colores única para cada valor único
colores <- rainbow(length(colores_unicos))
# Asignar un color correspondiente a cada valor único
colores_asignados <- colores[match(registros_mas_frecuentes$Color_de_Cabello, colores_unicos)]
grafico_meses <- faces(registros_mas_frecuentes[,5],col.hair = colores_asignados)
# 12 caras por los meses, color pelo dias ... y color cara ruta
grafico_meses <- faces(registros_mas_frecuentes[,5],col.hair = registros_mas_frecuentes$NumeroDia)
# 12 caras por los meses, color pelo dias ... y color cara ruta
#obtenemos los meses, dias y la ruta donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)
numero_mes <- seq(1, 12, length.out = nrow(registros_mas_frecuentes))
numero_mes <- as.integer(numero_mes)
registros_mas_frecuentes <- cbind(registros_mas_frecuentes, NumeroMes = numero_mes)
# Crear una columna para el número de día según el día de la semana en registros_mas_frecuentes
registros_mas_frecuentes$NumeroDia <-ifelse(registros_mas_frecuentes$Día == "1.Domingo", "blue",
ifelse(registros_mas_frecuentes$Día == "2.Lunes", "red",
ifelse(registros_mas_frecuentes$Día == "3.Martes", "yellow",
ifelse(registros_mas_frecuentes$Día == "4.Miércoles", "cyan",
ifelse(registros_mas_frecuentes$Día == "5.Jueves", "darkgreen",
ifelse(registros_mas_frecuentes$Día == "6.Viernes", "brown",
ifelse(registros_mas_frecuentes$Día == "7.Sábado", "black", NA)))))))
print(registros_mas_frecuentes)
grafico_meses <- faces(registros_mas_frecuentes[,5],col.hair = registros_mas_frecuentes$NumeroDia)
# 12 caras por los meses, color pelo dias ... y color cara ruta
grafico_meses <- faces(registros_mas_frecuentes[,5],face.type = "chernoff",col.hair = registros_mas_frecuentes$NumeroDia)
# 12 caras por los meses, color pelo dias ... y color cara ruta
grafico_meses <- faces(registros_mas_frecuentes[,5],face.type = "chernoff",col.hair = registros_mas_frecuentes$NumeroDia)
# 12 caras por los meses, color pelo dias ... y color cara ruta
#obtenemos los meses, dias y la ruta donde
#mas accidentes hay
meses_dias_RU_mas_accidentes <- data %>%
filter(grepl("^[A-L]\\..*\\s(Enero|Febrero|Marzo|Abril|Mayo|Junio|Julio|Agosto|Setiembre|Octubre|Noviembre|Diciembre)$", Mes)) %>%
filter(grepl("^[1-7]\\.(Domingo|Lunes|Martes|Miércoles|Jueves|Viernes|Sábado)$", Día)) %>%
group_by(Mes,Día,Ruta) %>%
summarise(MDtotal_accidentes = n()) %>%
arrange(desc(MDtotal_accidentes))
registros_mas_frecuentes <- meses_dias_RU_mas_accidentes %>%
group_by(Mes) %>%
slice(1)
numero_mes <- seq(1, 12, length.out = nrow(registros_mas_frecuentes))
numero_mes <- as.integer(numero_mes)
registros_mas_frecuentes <- cbind(registros_mas_frecuentes, NumeroMes = numero_mes)
# Crear una columna para el número de día según el día de la semana en registros_mas_frecuentes
registros_mas_frecuentes$ColorDia <-ifelse(registros_mas_frecuentes$Día == "1.Domingo", "blue",
ifelse(registros_mas_frecuentes$Día == "2.Lunes", "red",
ifelse(registros_mas_frecuentes$Día == "3.Martes", "yellow",
ifelse(registros_mas_frecuentes$Día == "4.Miércoles", "cyan",
ifelse(registros_mas_frecuentes$Día == "5.Jueves", "darkgreen",
ifelse(registros_mas_frecuentes$Día == "6.Viernes", "brown",
ifelse(registros_mas_frecuentes$Día == "7.Sábado", "black", NA)))))))
print(registros_mas_frecuentes)
grafico_meses <- faces(registros_mas_frecuentes[,5],face.type = "chernoff",col.hair = registros_mas_frecuentes$ColorDia)
# 12 caras por los meses, color pelo dias ... y color cara ruta
grafico_meses <- faces(rep(1, nrow(registros_mas_frecuentes)), face.type = "chernoff", col.hair = colores_asignados)
# 12 caras por los meses, color pelo dias ... y color cara ruta
grafico_meses <- faces(registros_mas_frecuentes$NumeroMes,face.type = "chernoff",col.hair = registros_mas_frecuentes$ColorDia)
# 12 caras por los meses, color pelo dias ... y color cara ruta
grafico_meses <- faces(registros_mas_frecuentes[,5],face.type = "chernoff",col.hair = registros_mas_frecuentes$ColorDia)
# 12 caras por los meses, color pelo dias ... y color cara ruta
